http://www.cs.cornell.edu/~kb/publications/SIG15ProductNet.pdf

siamese margin :
with L2 norm : m =root(0.2)

training  with stochastic gradient descent (SGD)

モデルの初期化：caffenet

remove softmax
replace last layer with inner production layer : size 256, 1024, 4096

replace fc8 by new layer fc9 (input image is square, size is  64x64, 128x128,25x256)
256, 1024, and 4096 all perform  is same -> let use 1024

ネットワークが収束した後、 t-SNE を利用して全てのデータを2d次元空間に表示

image size = 256x256
crop same as imagenet

positive: nagative = 1:20

how to test:  input a image -> show the similar image

finetune from caffe net, so value: 1 instead of value: 0.1




import sys, os, leveldb, cv2, h5py
import numpy as np

sys.path.append("/export/space2/vugia/caffe/python/")
import caffe

from caffe.proto import caffe_pb2

db = leveldb.LevelDB('/export/space/vugia/tmp/UCF-101_temporal/trainlist01_1opflows_h5_all_40_shuffled/');

for count in range(1, 10000):
    key = '{:08}'.format(count);
    datum = caffe_pb2.Datum.FromString(db.Get(key));
    print datum.label
    time.sleep(0.05)
